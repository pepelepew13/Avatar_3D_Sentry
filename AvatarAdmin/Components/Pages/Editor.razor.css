/* Editor.razor.css — “Avatar Studio” con submenú lateral, slide in/out y full height */
:host{ display:block }

/* ===== SHELL ===== */
.vg-shell{
  --rail-w: 320px;
  --canvas-radius: 18px;

  display:grid; grid-template-columns: var(--rail-w) 1fr; gap:.75rem;
  height: 93dvh;            /* <- se ajusta al alto de layout-content */
  overflow: clip;          /* evita scroll fantasma */
}

/* ===== RAIL ===== */
.vg-rail{
  position:relative; /* subpanel se posiciona respecto al rail */
  display:flex;
  z-index: 10;
  flex-direction:column;
  gap:.6rem;
  height: 100%;
  background: linear-gradient(180deg, rgba(0,0,0,.02), rgba(0,0,0,.06)), #fff;
  border:1px solid var(--line-strong); border-radius:18px; box-shadow: var(--shadow-md);
  padding:.8rem;
  overflow: visible;
}
.vg-rail-head{ display:flex; align-items:center; justify-content:space-between; gap:.5rem }
.brand{ display:flex; gap:.5rem; align-items:center }
.brand-logo{ width:44px;height:44px; object-fit:contain }
.brand-copy strong{ display:block; line-height:1.1 }
.brand-copy small{ color: var(--muted) }

.rail-badge{
  display:inline-flex; align-items:center; gap:.4rem; font-weight:900; letter-spacing:.06em;
  padding:.28rem .6rem; border-radius:999px; background: rgba(0,20,137,.10); border:1px solid rgba(0,20,137,.25);
  color:#001489; text-transform:uppercase; font-size:.72rem;
}
.rail-badge .dot{ width:8px;height:8px;border-radius:50%;background:#22c55e; box-shadow:0 0 0 6px rgba(34,197,94,.14) }

.vg-rail-nav{
  display:grid; gap:.4rem; margin-top:.3rem;
  background: var(--surface-alt); border:1px solid var(--line); border-radius:14px; padding:.45rem;
  overflow:auto; max-height: calc(100% - 250px);
  scrollbar-width: thin;
}
.vg-rail-btn{
  display:flex; align-items:center; gap:.5rem; border-radius:10px; border:1px solid transparent;
  background:#fff; padding:.5rem .6rem; cursor:pointer; font-weight:800;
  transition: transform .08s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
}
.vg-rail-btn .ic{ width:28px;height:28px; display:grid; place-items:center; border-radius:8px; background:#f3f6fb; border:1px solid var(--line) }
.vg-rail-btn:hover{ background:#f7f9fc }
.vg-rail-btn.active{
  border-color: color-mix(in srgb, var(--brand-red) 28%, #fff);
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--brand-red) 18%, #fff);
}

/* ===== RAIL FORM (card pulida) ===== */
.vg-rail-form{
  display:flex; flex-direction:column; gap:.65rem;
  background:
    linear-gradient(180deg, rgba(255,255,255,.82), rgba(255,255,255,.96));
  border:1px solid var(--line-strong);
  border-radius:14px;
  box-shadow: var(--shadow-sm);
  padding:.65rem;
  margin-top:.35rem;
}

/* Grid del formulario: 1 col → 2 cols en pantallas amplias */
.vg-form{
  display:grid; gap:.6rem;
}
@media (min-width: 1200px){
  .vg-form{
    grid-template-columns: 1fr 1fr;
    align-items:start;
  }
  .vg-form .btn-load{ grid-column: 1 / -1; }
}

/* Campo (label + input + hint) */
.vg-field{
  display:flex; flex-direction:column; gap:.35rem;
  background:#fff;
  border:1px solid var(--line);
  border-radius:12px;
  padding:.55rem .6rem;
  transition: border-color .12s ease, box-shadow .12s ease, transform .06s ease;
}
.vg-field:hover{ border-color: color-mix(in srgb, var(--brand-blue) 18%, var(--line)); }
.vg-field:focus-within{
  border-color: color-mix(in srgb, var(--brand-blue) 40%, var(--line));
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand-blue) 18%, transparent);
}

.vg-field label{
  font-weight:800; font-size:.82rem; letter-spacing:.01em;
  color:#3c3c43; /* iOS-y */
}
.vg-field .hint{
  color: var(--muted);
  font-size:.78rem;
  margin-top:-.1rem;
}

/* Inputs pulidos (respetando tus clases existentes) */
.vg-field .form-control,
.vg-field .form-select{
  height: 38px;
  border-radius:10px;
  border:1px solid var(--line);
  background:#fff;
  padding:.45rem .55rem;
  transition: border-color .12s ease, box-shadow .12s ease, background .12s ease;
}
.vg-field .form-control::placeholder{ color:#9aa1ab }
.vg-field .form-control:hover,
.vg-field .form-select:hover{
  border-color: color-mix(in srgb, var(--brand-blue) 18%, var(--line));
}
.vg-field .form-control:focus,
.vg-field .form-select:focus{
  outline:none;
  border-color: color-mix(in srgb, var(--brand-blue) 42%, var(--line));
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand-blue) 22%, transparent);
}

/* Estado inválido opcional: añade data-invalid="true" al input si lo usas */
.vg-field [data-invalid="true"]{
  border-color: color-mix(in srgb, var(--brand-red) 60%, var(--line));
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand-red) 18%, transparent);
}
.vg-field [data-invalid="true"] + .hint{
  color: color-mix(in srgb, var(--brand-red) 70%, #a1a1aa);
}

/* Botón superior de carga dentro del form */
.btn-load{
  border-radius:12px;
  font-weight:800;
  height:40px;
  background: #fff;
  border:1px dashed var(--line);
}
.btn-load:hover{ background:#f7f9fc }

/* Pulido del contenedor de acciones que ya tenías */
.rail-actions{
  margin-top: .25rem; /* leve ajuste al nuevo card */
}

.rail-actions{
  margin-top: auto;
  position: sticky; bottom: .6rem;
  padding-top: .55rem;
  border-top: 1px dashed var(--line);
  background: linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.92));
  border: 1px solid var(--line-strong);
  border-radius: 12px;
  box-shadow: var(--shadow-sm);
  padding: .5rem;
}
.rail-actions .btn{ width: 100%; border-radius: 12px; font-weight: 800 }
.rail-actions .btn + .btn{ margin-top: .45rem }

@media (max-width: 1024px){
  .rail-actions{ position: static; margin-top: .6rem }
}

/* ===== SUBMENÚ (anclado al botón, con slide in/out) ===== */
.vg-sub{
  position:absolute; /* top inline desde Razor; left fijo */
  left: calc(100% + .6rem);
  width: max-content;
  max-width: 56vw;
  max-height: calc(100dvh - 16px);
  background:#fff; border:1px solid var(--line-strong); border-radius:16px; box-shadow: var(--shadow-lg);
  padding:.55rem; display:flex; flex-direction:column; gap:.55rem; align-items: center;
  overflow:auto; z-index:20; pointer-events:auto;

  /* estado base (si aparece sin clases) */
  opacity: 0;
  transform: translateX(-8px) scale(.98);
}
.vg-sub.is-open{
  animation: subSlideIn 160ms cubic-bezier(.2,.8,.2,1) forwards;
  transform-origin: left top;
}
.vg-sub.is-closing{
  animation: subSlideOut 160ms cubic-bezier(.2,.8,.2,1) forwards;
  transform-origin: left top;
}
@keyframes subSlideIn{
  from{ opacity: 0; transform: translateX(-8px) scale(.98) }
  to  { opacity: 1; transform: translateX(0)    scale(1) }
}
@keyframes subSlideOut{
  from{ opacity: 1; transform: translateX(0)    scale(1) }
  to  { opacity: 0; transform: translateX(-8px) scale(.98) }
}

.sub-card{
  background:#fff; border:1px solid var(--line-strong); border-radius:14px; box-shadow: var(--shadow-sm);
  display:flex; flex-direction:column; align-items: center;
}
.sub-head{ padding:.5rem .6rem; border-bottom:1px dashed var(--line) }
.sub-head h6{ margin:0; font-weight:900; letter-spacing:.02em }
.sub-body{ padding:1rem 1rem; display: flex; align-items: center; flex-direction: column;}
.sub-body.grid2{ display:grid; grid-template-columns: 1fr 1fr; gap:.5rem }

/* ===== STAGE ===== */
.vg-stage{
  display:grid; grid-template-rows: auto 1fr; gap:.6rem;
  min-height: 0;
  overflow: clip; /* evita rebalse dentro del layout-content */
}

/* Topbar */
.vg-topbar{
  display:flex; align-items:center; justify-content:space-between; gap:.6rem;
  background: linear-gradient(180deg, rgba(255,255,255,.6), rgba(255,255,255,.3));
  border:1px solid var(--line-strong); border-radius:14px; box-shadow: var(--shadow-sm); padding:.5rem .6rem;
}
.vg-tags{ display:flex; gap:.35rem; flex-wrap:wrap }
.tag{ display:inline-flex; align-items:center; gap:.35rem; padding:.22rem .55rem; border-radius:999px; font-weight:800; font-size:.82rem; border:1px solid var(--line); background:#fff }
.tag-blue{  background: rgba(0,20,137,.10); border-color: rgba(0,20,137,.25); color:#001489 }
.tag-yellow{ background: rgba(255,205,0,.15); border-color: rgba(255,205,0,.35); color:#6b4f00 }
.tag-gray{   background: var(--surface-alt) }

.vg-tools{ display:flex; align-items:center; gap:.4rem }
.vg-tools .sep{ width:1px; height:22px; background:var(--line); opacity:.7 }
.icon-btn{
  width:38px; height:38px; display:grid; place-items:center; border-radius:10px; border:1px solid var(--line);
  background:#fff; color:#111; box-shadow: var(--shadow-xs);
  transition: transform .12s ease, background .12s ease, box-shadow .12s ease, border-color .12s ease;
  cursor:pointer;
}
.icon-btn:hover{ transform: translateY(-1px); background:#f3f6fb }
.icon-btn--danger{ background:linear-gradient(135deg,var(--brand-red),var(--brand-red-2)); color:#fff; border-color:transparent }
.icon-btn--danger:hover{ filter:brightness(1.05) }

/* ===== CANVAS ===== */
.vg-canvas{
  position:relative; min-height: 0;
  background:
    radial-gradient(120% 160% at -20% -30%, color-mix(in srgb, var(--brand-red) 10%, transparent) 0 55%, transparent 56%),
    radial-gradient(120% 160% at 120% -20%, color-mix(in srgb, var(--brand-blue) 12%, transparent) 0 55%, transparent 56%),
    linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.6));
  border:1px solid var(--line-strong); border-radius: var(--canvas-radius); box-shadow: var(--shadow-lg);
  overflow:hidden;
}
.avatar-viewer-canvas{
  position:absolute; inset:0; width:100%; height:100%; display:block; outline:none; border-radius: var(--canvas-radius);
  filter: drop-shadow(0 18px 25px rgba(15,47,58,.22));
}
.vg-canvas-hint{
  position:absolute; left:12px; bottom:12px; display:flex; gap:.45rem; align-items:center;
  background: rgba(0,0,0,.35); color:#fff; border:1px solid rgba(255,255,255,.28);
  border-radius:10px; padding:.35rem .55rem; backdrop-filter: blur(6px);
  font-size:.9rem; font-weight:700;
}
.kbd{ font-family: ui-monospace,Menlo,Consolas,monospace; font-size:.8rem; border:1px solid rgba(255, 255, 255, 0.28); border-radius:6px; padding:.06rem .3rem; background: rgba(0,0,0,.4); color: brown; }
.scanlines{ position:absolute; inset:0; pointer-events:none; opacity:.2; background-image: repeating-linear-gradient(to bottom, rgba(0,0,0,.12) 0, rgba(0,0,0,.12) 1px, transparent 1px, transparent 3px) }

/* Loading */
.vg-loading{ position:absolute; inset:0; display:grid; place-items:center; gap:.4rem; background: rgba(255,255,255,.35); backdrop-filter: blur(2px) }
.vg-loading .spinner{ width:34px; height:34px; border-radius:50%; border:3px solid rgba(0,0,0,.15); border-top-color: var(--brand-red); animation: spin 1s linear infinite }
.vg-loading .txt{ font-weight:800; color:#374151 }
@keyframes spin{ to{ transform: rotate(360deg) } }

/* ===== LOGO PREVIEW ===== */
.vg-logo-preview{
  width: 220px; height: 72px; display:flex; align-items:center; justify-content:center;
  background:#fff; border:1px dashed var(--line); border-radius:12px; box-shadow: var(--shadow-xs);
  overflow:hidden; margin-bottom:.45rem;
}
.vg-logo-preview img{ max-width:100%; max-height:100%; object-fit:contain }

/* ===== PRESETS y SWATCHES ===== */
.preset-grid{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:.5rem }
.preset-tile{
  position:relative; display:flex; flex-direction:column; align-items:center; gap:.35rem;
  border:1px solid var(--line); border-radius:12px; overflow:hidden; background:#fff; cursor:pointer;
  transition: transform .08s ease, box-shadow .12s ease, border-color .12s ease, filter .12s ease;
}
.preset-tile img{ width:100%; aspect-ratio: 16/10; object-fit:cover; display:block }
.preset-tile span{ font-weight:800; font-size:.9rem; padding:.35rem }
.preset-tile:hover{ transform: translateY(-1px); box-shadow: var(--shadow-sm) }
.preset-tile.active{
  border-color: color-mix(in srgb, var(--brand-red) 32%, #fff);
  box-shadow: inset 0 0 0 2px color-mix(in srgb, var(--brand-red) 18%, #fff), var(--shadow-sm);
}
.vg-swatches{ display:flex; flex-wrap:wrap; gap:.35rem }
.swatch{
  width:34px; height:34px; border-radius:10px; border:2px solid #fff;
  box-shadow: 0 4px 12px rgba(0,0,0,.12);
  background: var(--sw, #888); cursor:pointer;
  transition: transform .04s ease, box-shadow .12s ease, outline .12s ease;
  outline: 1px solid rgba(0,0,0,.18);
}
.swatch:hover{ transform: translateY(-1px) }
.swatch.active{ outline: 2px solid color-mix(in srgb, var(--brand-blue) 42%, #fff) }

/* ===== FORM/BUTTONS ===== */
.form-control, .form-select{ border-radius:12px }
.btn{ border-radius:12px; font-weight:800; letter-spacing:.02em }
.btn-primary{ background: linear-gradient(135deg, var(--brand-red), var(--brand-red-2)); border: none; color:#fff }
.btn-outline-light{ border: 1px solid var(--line-strong); background:#fff; color:#111 }
.btn-outline-light:hover{ background:#f7f9fc }

/* ===== RESPONSIVE ===== */
@media (max-width: 1200px){
  .vg-shell{ --rail-w: 300px }
}
@media (max-width: 1024px){
  .vg-shell{ grid-template-columns: 1fr; height: 100dvh }
  .vg-rail{ height:auto }
  .vg-rail-nav{ max-height:none }
  .vg-sub{
    position:static; width:auto; max-width: none; height:auto; margin-top:.6rem;
    box-shadow: var(--shadow-md);
    animation: none; opacity:1; transform:none;
  }
  .vg-stage{ height: calc(100dvh - 16px) }
}
@media (max-width: 640px){
  .preset-grid{ grid-template-columns: repeat(2, minmax(0,1fr)) }
}
